---
title: "Indian House Price Prediction Project"
author: "Swarnava Kundu"
format: html
editor: visual
---

## File description:

The India Housing Prices Data set contains 2.5 lakh rows and 23 columns, offering detailed insights into housing market trends across various Indian states. It includes attributes related to property types, pricing, location, and amenities, making it suitable for analysis ranging from basic descriptive statistics to advanced machine learning applications.

```{r}
dt = read.csv(file = "D:/MTTS STDSMLAI/Indian_House_Pricing_Project/india_housing_prices.csv", 
              header = TRUE)
#head(dt,n=3)
```

```{r}
dim(dt)
```

```{r}
colnames(dt)
```

## Column Description

Some understanding from our Data set

-   **ID**: Different rows having different Integer values

-   **State**: Name of States of India ( character )

-   **City**: Name of Cities ( character )

-   **Locality**: Name of Localities ( character )

-   **Property_Type**: 3 types of property. ( Apartment, Independent House, Villa )

-   **BHK**: 5 varieties are there. ( 1,2,3,4,5)

-   **Size_in_sqFt**: Plot size in Sqft. ( integer )

-   **Price_in_Lakhs**: House price in Lakhs ( Double )

-   **Price_per_SqFt**: House price per Sqft. ( Double )

-   **Year_Built**: Year of built. ( integer )

-   **Furnished_Status**: Furnished Status ( Furnished, Unfurnished, Semi-furnished )

-   **Floor_No**: Floor No ( Integer )

-   **Total_Floors**: Total floor in the house ( Integer )

-   **Age_of_Property**: Age of property ( Integer )

-   **Nearby_Schools**: No. of nearby schools. ( Integer )

-   **Nearby_Hospitals**: No. of nearby hospital. ( Integer )

-   **Public_Transport_Accessibility**: Chance of getting Public Transportation (High, Low, Medium )

-   **Parking_Space**: Parking Space present or not ( Yes, No )

-   **Security**: ( Yes, No )

-   **Amenities**: Amenities like: Playground, Gym, Pool, etc.

-   **Facing**: House Facing in which Direction ( East, West, South, North )

-   **Owner_Type**: Type of owner ( Owner, Builder, Broker )

-   **Availability_Status**: Status of availability ( Ready_to_move, Under_construction )

```{r}
typeof(dt$Availability_Status)
length(unique(dt$Availability_Status))
```

```{r}
summary(dt$Size_in_SqFt)
```

```{r}
boxplot(dt$Size_in_SqFt,horizontal = TRUE, 
        main = "Size of the Property",
        xlab = "Distribution of Property Sizes",
        ylab = "Size (sq ft)")
hist(dt$Size_in_SqFt, breaks = 30,probability = TRUE,
       main="Distribution of Property Sizes", 
     xlab="Size (sq ft)", ylim= c(0,0.00030))
```

```{r}
summary(dt$Price_in_Lakhs)
val = dt$Price_in_Lakhs/10
summary(val)
boxplot(dt$Price_in_Lakhs,horizontal = TRUE, 
        main = "Price of the Property",
        xlab = "Distribution of Property prices",
        ylab = "Price (Lakhs)")
hist(dt$Price_in_Lakhs, breaks = 20,probability = TRUE,
       main="Distribution of Property Prices", 
     xlab="Price (Lakhs)")
```

```{r}
summary(dt$Price_per_SqFt)
boxplot(dt$Price_per_SqFt,horizontal = TRUE,
         main = "Price per SqFt of the Property",
        xlab = "Distribution of Property prices per SqFt",
        ylab = "Price (per SqFt)")
hist( dt$Price_per_SqFt, breaks = 30,
    main="Distribution of Property prices per SqFt", 
    xlab="Price (per SqFt)")
```

-   The data is **positively skewed (right-skewed).**

-   The majority of the property prices are clustered at the lower end of the scale (between 0.0 and 0.2).

-   Here is a long tail extending toward the right. This indicates that while most properties are relatively affordable (on this scale), there are a few properties with significantly higher prices per square foot.

## Observation From Data

### Pricing

-   **Price_in_Lakhs = Size_in_SqFt × Price_per_SqFt** + (Some dynamic Charge/ Discount )

```{r}
Price_diff <- dt$Price_in_Lakhs - (dt$Size_in_SqFt * dt$Price_per_SqFt)
typeof(dt$Size_in_SqFt)
pos_price_diff = sum(round(Price_diff,4) > 0.0)
no_price_diff = sum(round(Price_diff,2) == 0.0)
neg_price_diff = sum(round(Price_diff,4) < 0.0)
print((pos_price_diff+no_price_diff+neg_price_diff))
```

50.29% data have more price than the equation.

49.65% data having less price than the equation.

And 0.05% data having exactly same value.

### Locality

```{r}
#| warning: false
library(dplyr)
locality_summary <- dt %>%
  group_by(City) %>%
  summarize(
    localities = paste(unique(Locality), collapse = ", "),
    no_localities = length(unique(Locality))
  )
print(locality_summary)

```

After grouping by state and city, By random check i see that Locality_463 is present in Ahmadabad and Bhopal.

Now i do a quick search to find in which cities it is present.

```{r}
dt %>%
  filter(Locality == "Locality_463") %>%
  distinct(City)
```

It gives that it is present under 42 cities.

**Each city has 500 localities .**

```{r}
length(unique(dt$Locality))
```

Also there are 500 localities in total. Then the common observation is that all 500 localities are common in all cities.

### Year Built

```{r}
length(unique(sort(dt$Year_Built)))
summary(dt$Year_Built)
```

### City

```{r}
#State wise city count
City_summary <- dt %>%
  group_by(State) %>%
  summarize(
    Cities = paste(unique(City), collapse = ", "),
    no_cities = length(unique(City))
  )
```

### BHK

```{r}
BHK_summary <- dt %>%
  group_by(State) %>%
  summarize(
    BHKs = paste(unique(BHK), collapse = ", "),
    no_BHK = length(unique(BHK))
  )
```

All States have all type of BHK options.

```{r}
BHK_summary2 <- dt %>%
  group_by(City) %>%
  summarize(
    BHKs = paste(unique(BHK), collapse = ", "),
    no_BHK = length(unique(BHK))
  )
```

Also, all cities have all BHK options.

```{r}
BHK_summary3 <-dt %>%
  group_by(City) %>%
  summarise(count_5bhk = sum(BHK == "5", na.rm = TRUE))
```

### Property

```{r}
#Counting of properties each States have
Property_list = dt %>%
  group_by(City) %>%
  summarise(count_prop = length(unique(ID)))

```

```{r}
#| warning: false
#Rechecking the sum of the count column is matching or not!
Property_list %>%
  summarise(across(count_prop, sum, na.rm = TRUE))
```

```{r}
Property_list$City[which.max(Property_list$count_prop)]
```

So, Coimbatore has maximum properties.

```{r}
city_prop_type= dt %>%
  group_by(City) %>%
  summarise(count_prop_type = length(unique(Property_Type)))
```

All cities have all the 3 varieties of property.

```{r}
# Property type wise Average Price
Price_per_prop= aggregate(Price_in_Lakhs ~ Property_Type + Availability_Status, data = dt, FUN = mean)
Price_per_prop
```

```{r}
# Property type wise Average Price per SqFt
Price_per_sqft_prop= aggregate(Price_per_SqFt ~ Property_Type + Availability_Status, data = dt, FUN = median)
Price_per_sqft_prop
```

### Year Wise Price Change Analysis

```{r}
data_1990 = dt[dt$Year_Built == 1990,]
summary(data_1990$Price_in_Lakhs)
hist(data_1990$Price_in_Lakhs,breaks = 30,probability = TRUE,
     main="Distribution of Property prices in 1990", 
    xlab="Price (in Lakhs)", ylim= c(0,0.0030))
```

```{r}
data_1991 = dt[dt$Year_Built == 1991,]
summary(data_1991$Price_in_Lakhs)
hist(data_1991$Price_in_Lakhs,breaks = 30,probability = TRUE,
     main="Distribution of Property prices in 1991", 
    xlab="Price (in Lakhs)" , ylim= c(0,0.0030))

```

-   Kind of same summary are there for these two years.

```{r}
# Calculate the yearly statistics
yearly_mean <- aggregate(Price_in_Lakhs ~ Year_Built, data = dt, FUN = mean)
yearly_min  <- aggregate(Price_in_Lakhs ~ Year_Built, data = dt, FUN = min)
yearly_max  <- aggregate(Price_in_Lakhs ~ Year_Built, data = dt, FUN = max)
yearly_median <- aggregate(Price_in_Lakhs ~ Year_Built, data = dt, FUN = median)
```

-   

    ```{r}
    par(mfrow = c(3, 1), mar = c(4, 4, 2, 1))
    # Create the initial plot with the Max 
    # 1. The Maximum line (Dashed red)
    plot(x = yearly_max$Year_Built, yearly_max$Price_in_Lakhs, 
          type = "o", col = "red", lty = 2, pch = 18,
          xlab = "Year Built", 
         ylab = "Price (in Lakhs)",
         main = "Yearly Price Trends: Max")

    # 2.Add The mean line
    plot(yearly_mean$Year_Built, yearly_mean$Price_in_Lakhs, 
         type = "o", 
         pch = 19,
         col = "darkgreen",
         xlab = "Year Built", 
         ylab = "Price (in Lakhs)",
         main = "Yearly Price Trends: Mean")

    # 3. Add the Minimum line (Dashed blue)
    plot(yearly_min$Year_Built, yearly_min$Price_in_Lakhs, 
          type = "o", col = "blue", lty = 2, pch = 18,
          xlab = "Year Built", 
         ylab = "Price (in Lakhs)",
         main = "Yearly Price Trends: Min")
    ```

-   The Mean price fluctuates within a very narrow band (roughly between **251 and 257 Lakhs**). This tells us that despite individual year-to-year variations, the house price didn't change drastically over the years.

```{r}
d1= dt[which(dt$Availability_Status=="Ready_to_Move"),]
yearly_mean_ready <- aggregate(Price_in_Lakhs ~ Year_Built,data = 
                                 dt[which(dt$Availability_Status  =="Ready_to_Move"), ], FUN = mean)
plot(yearly_mean_ready,  type = "o", 
     pch = 19,
     col = "darkgreen",
     xlab = "Year Built", 
     ylab = "Price (in Lakhs)",
     main = "Yearly Price Trends: Ready_to_Move vs Under_Construction")

#For Under_Construction House
yearly_mean_cons <- aggregate(Price_in_Lakhs ~ Year_Built,data = 
                                 dt[which(dt$Availability_Status  =="Under_Construction"), ], FUN = mean)
lines(yearly_mean_cons,  lty=2, type = "o", 
     pch = 19,
     col = "blue")
#For average Price line
lines(yearly_mean$Year_Built, yearly_mean$Price_in_Lakhs,lty = 3, type = "o", 
     pch = 19,
     col = "red")

#Legend
legend("topleft", 
       legend = c("Ready_to_Move", "Under_Construction", "Mean Price"),
       col = c("darkgreen", "blue","red"), 
       lty = c(1, 2,3), 
       pch = c(19, 19,19),
       bty = "n")


```

```{r}
### Calculation for Median
yearly_median_ready <- aggregate(Price_in_Lakhs ~ Year_Built,data = 
                                 dt[which(dt$Availability_Status  =="Ready_to_Move"), ], FUN = median)
plot(yearly_mean_ready,  type = "o", 
     pch = 19,
     col = "darkgreen",
     xlab = "Year Built", 
     ylab = "Price (in Lakhs)",ylim= c(242,265),
     main = "Yearly Median Price Trends: Ready_to_Move vs Under_Construction")

#For Under_Construction House
yearly_mean_cons <- aggregate(Price_in_Lakhs ~ Year_Built,data = 
                                 dt[which(dt$Availability_Status  =="Under_Construction"), ], FUN = median)
lines(yearly_mean_cons,  lty=2, type = "o", 
     pch = 19,
     col = "blue")
#For average Price line
lines(yearly_mean$Year_Built, yearly_median$Price_in_Lakhs,lty = 3, type = "o", 
     pch = 19,
     col = "red")

#Legend
legend("topleft", 
       legend = c("Ready_to_Move", "Under_Construction", "Median Price"),
       col = c("darkgreen", "blue","red"), 
       lty = c(1, 2,3), 
       pch = c(19, 19,19),
       bty = "n")


```

```{r}
### Calculation for Median
yearly_median_ready <- aggregate(Price_per_SqFt ~ Year_Built,data = 
                                 dt[which(dt$Availability_Status  =="Ready_to_Move"), ], FUN = median)
plot(yearly_median_ready,  type = "o", 
     pch = 19,
     col = "darkgreen",
     xlab = "Year Built", 
     ylab = "Price (per SqFt)",
     main = "Yearly Median Price Trends: Ready_to_Move vs Under_Construction")

#For Under_Construction House
yearly_median_cons <- aggregate(Price_per_SqFt ~ Year_Built,data = 
                                 dt[which(dt$Availability_Status  =="Under_Construction"), ], FUN = median)

lines(yearly_median_cons,  lty=2, type = "o", 
     pch = 19,
     col = "blue")
#For Median Price line
yearly_median_sqft <- aggregate(Price_per_SqFt ~ Year_Built, data = dt, FUN = median)
lines(yearly_median$Year_Built, yearly_median$Price_per_SqFt,lty = 3, type = "o", 
     pch = 19,
     col = "red")

#Legend
legend("center", 
       legend = c("Ready_to_Move", "Under_Construction", "Median Price"),
       col = c("darkgreen", "blue","red"), 
       lty = c(1, 2,3), 
       pch = c(19, 19,19),
       bty = "n")
```

### Facing Direction

```{r}
facing_counts <- table(dt$Facing)
par(mar = c(5, 6, 4, 2),mgp = c(4, 1, 0))

bp = barplot(table(dt$Facing), 
        main = "Property Distribution by Facing Direction",
        col = "steelblue",
        xlab = "Direction",
        ylab = "Number of Houses",  ylim= c(0,70000), 
        las = 1) # las=2 makes labels vertical if they are long

#Counting of houses facing each Direction
#table(dt$Facing)

text(x = bp, 
     y = facing_counts, 
     labels = facing_counts, 
     pos = 3, 
     cex = 0.8, 
     font = 2)
```

```{r}
#The average prices of houses based on their facing direction
avg_price_summary <- dt %>%
  group_by(Facing) %>%
  summarise(Average_Price = mean(Price_in_Lakhs),
            Property_Count = n()) %>%
  arrange(desc(Average_Price))

print(avg_price_summary)
```

```{r}
# 1. Generate frequency tables for all four directions
n_counts <- table(dt$Year_Built[dt$Facing == "North"])
s_counts <- table(dt$Year_Built[dt$Facing == "South"])
e_counts <- table(dt$Year_Built[dt$Facing == "East"])
w_counts <- table(dt$Year_Built[dt$Facing == "West"])

# 2. Determine the maximum count across all directions to set the Y-axis limit
max_val <- max(c(n_counts, s_counts, e_counts, w_counts))

# 3. Plot the first direction (North) to set up the window
# We use as.numeric(names()) to get the years on the X-axis
plot(as.numeric(names(n_counts)), as.numeric(n_counts), 
     type = "o", 
     col = "blue", 
     pch = 19,
     ylim = c(1700, max_val * 1.05), # Add 20% headroom for the legend
     xlab = "Year Built", 
     ylab = "Number of Houses Sold",
     main = "Year-wise Property Sales by Facing Direction")

# 4. Add the lines for the other three directions
lines(as.numeric(names(s_counts)), as.numeric(s_counts), type = "o", col = "red", pch = 19)
lines(as.numeric(names(e_counts)), as.numeric(e_counts), type = "o", col = "darkgreen", pch = 19)
lines(as.numeric(names(w_counts)), as.numeric(w_counts), type = "o", col = "orange", pch = 19)

# 5. Add a legend to differentiate the directions
legend("topleft", 
       legend = c("North", "South", "East", "West"), 
       col = c("blue", "red", "darkgreen", "orange"), 
       lty = 1, 
       pch = 19, 
       bty = "n") # Removes the legend box border for a cleaner look
```

### Age of Property

```{r}
# Calculate the age statistics
age_mean <- aggregate(Price_in_Lakhs ~ Age_of_Property, data = dt, FUN = mean)
age_min  <- aggregate(Price_in_Lakhs ~ Age_of_Property, data = dt, FUN = min)
age_max  <- aggregate(Price_in_Lakhs ~ Age_of_Property, data = dt, FUN = max)
age_median <- aggregate(Price_in_Lakhs ~ Age_of_Property, data = dt, FUN = median)

plot(age_mean$Age_of_Property, age_mean$Price_in_Lakhs, 
     type = "o", lty = 1,
     pch = 19,
     col = "darkgreen",
     xlab = "Age of Property", 
     ylab = "Price (in Lakhs)",ylim=c(246,259),
     main = "Age of property Price Trends: Mean vs Median")

lines(age_median$Age_of_Property, age_median$Price_in_Lakhs, 
     type = "o", lty = 2,
     pch = 19,
     col = "blue")

#Legend
legend("bottomright", 
       legend = c("Mean", "Median"),
       col = c("darkgreen", "blue"), 
       lty = c(1, 2), 
       pch = c(19, 19,19),
       bty = "n")
```

### Amenities

```{r}
#| warning: false
# install.packages("fastDummies")
library(fastDummies)

# split by ", " to create individual columns
dt_expanded <- dummy_cols(dt, 
                          select_columns = "Amenities", 
                          split = ", ")

# Optional: Remove the original 'Amenities' column if you no longer need it
dt_expanded$Amenities <- NULL
```

Extended Data set created.

```{r}
# Identify your amenity columns
amenity_cols <- c("Amenities_Garden", "Amenities_Clubhouse",
                  "Amenities_Pool", "Amenities_Gym", "Amenities_Playground","Parking_Space","Security") 

# Map "Yes" to 1 and "No" to 0
dt_expanded$Security <- ifelse(dt_expanded$Security == "Yes", 1, 0)
dt_expanded$Parking_Space <- ifelse(dt_expanded$Parking_Space == "Yes", 1, 0)

# Sum the columns to get the count of houses for each
amenity_counts <- colSums(dt_expanded[amenity_cols], na.rm = TRUE)

# Create a summary table
amenity_summary <- data.frame(
  Amenity = names(amenity_counts),
  Count = as.numeric(amenity_counts),
  Percentage = round((as.numeric(amenity_counts) / nrow(dt_expanded)) * 100, 2)
)
print(amenity_summary)
```

```{r}
# amenity columns
cols_to_compare <- c("Price_in_Lakhs", "Price_per_SqFt",
                     "Amenities_Garden", "Amenities_Clubhouse",
                  "Amenities_Pool", "Amenities_Gym", "Amenities_Playground")

#  Calculate the matrix
cor_matrix <- cor(dt_expanded[cols_to_compare])

# Correlation Plot
corrplot::corrplot(cor_matrix, 
         method = "color",       # Fills the tiles with color
         addCoef.col = "black",  # Color of the correlation coefficients
         number.cex = 0.7,       # Scale for the numbers
         type = "upper",         # Only shows the top triangle (cleaner look)
         diag = FALSE)
```

-   Correlation between Amenities and prices are 0 most of the cases.

```{r}
#Price for houses with amenity pool versus those without it
amenity_stats_pool <- aggregate(Price_in_Lakhs ~ Amenities_Pool, data = dt_expanded, 
                           FUN = function(x) c(Mean = mean(x), 
                                               Median = median(x), 
                                               SD = sd(x), 
                                               Min = min(x), 
                                               Max = max(x)))

# Convert to a readable data frame
amenity_stats_pool <- do.call(data.frame, amenity_stats_pool)
print(amenity_stats_pool)
```

-   Having amenity Pool and not having it , has less impact on our data.

```{r}
# Visualizing the impact of having a Gym on Price
boxplot(Price_in_Lakhs ~ Amenities_Gym , data = dt_expanded,
        main = "Price Distribution: Gym vs. No Gym",
        xlab = "Gym Presence (1 = Yes, 0 = No)",
        ylab = "Price (in Lakhs)",
        col = c("lightgrey", "gold"))
```

-   As like Pool; having Gym has less impact. Also all the amenities has less impact.

```{r}
# Create a function to calculate stats for each amenity
calculate_premium <- function(amenity_name) {
  # Mean price with the amenity
  mean_with <- mean(dt_expanded$Price_in_Lakhs[dt_expanded[[amenity_name]] == 1], na.rm = TRUE)
  
  # Mean price without the amenity
  mean_without <- mean(dt_expanded$Price_in_Lakhs[dt_expanded[[amenity_name]] == 0], na.rm = TRUE)
  
  # Calculate Premium
  premium_val <- mean_with - mean_without
  premium_pct <- (premium_val / mean_without) * 100
  
  # Return as a data frame row
  data.frame(
    Amenity = amenity_name,
    Avg_Price_With = round(mean_with, 2),
    Avg_Price_Without = round(mean_without, 2),
    Premium_Lakhs = round(premium_val, 2),
    Premium_Percent = round(premium_pct, 2)
  )
}

# 3. Apply the function to all columns and combine
premium_table <- do.call(rbind, lapply(amenity_cols, calculate_premium))

# 4. Sort by highest percentage premium
premium_table <- premium_table[order(-premium_table$Premium_Percent), ]

print(premium_table)
```

-   We can see very light impacts are their with the amenities. But Playground has negative premium. Means that it is popular in older years.

## Still Working...
